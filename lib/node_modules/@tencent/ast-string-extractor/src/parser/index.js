// const path = require('path');
const { isTsFile, isHtmlFile, isVueFile, isXmlFile } = require('../utils/file-langs');
const { parseVue } = require('./vue');
const { parseHtml } = require('./html');
const { parseXml } = require('./xml');
const jsTsParser = require('./js-ts');

module.exports = {
  parseCode: (code, filePath) => {
    if (isVueFile(filePath)) return parseVue(code, filePath);
    if (isHtmlFile(filePath)) return parseHtml(code);
    if (isXmlFile(filePath)) return parseXml(code);
    return jsTsParser.parseCode(code, filePath, isTsFile(filePath));
  },
  extractStrings: (ast, filePath, code) => {
    if (isVueFile(filePath)) return ast; // Vue 直接返回结果
    if (isHtmlFile(filePath)) return ast; // HTML 直接返回结果
    if (isXmlFile(filePath)) return ast; // XML 直接返回结果
    return jsTsParser.extractStrings(ast, isTsFile(filePath));
  },
  isValidString: (str) => {
    str = str.trim();
    // 检查字符串是否有效
    if (str.length < 5) {
      return false;
    }
    // 检查包含至少5个连续英文字母
    return /[a-zA-Z]{5,}/.test(str);
  }
};
